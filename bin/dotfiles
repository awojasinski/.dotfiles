#!/bin/bash
set -e

# Paths
DOTFILES_DIR="$HOME/.dotfiles"

# Ansible
if [[ "$OSTYPE" == "darwin"* ]]; then
    if ! brew list ansible > /dev/null 2>&1; then
        echo -e "Installing Ansible..."
        brew install ansible > /dev/null 2>&1
        echo -e "Ansible installed!"
        echo -e "Installing Ansible argument completion..."
        brew install python-argcomplete
        activate-global-python-argcomplete > /dev/null 2>&1
    fi
fi

# Clone .dotfiles repository
if ! [[ -d "$DOTFILES_DIR" ]]; then
    echo -e "Cloning repository: github.com/awojasinski/.dotfiles"
    git clone --quiet "https://github.com/awojasinski/.dotfiles.git" "$DOTFILES_DIR" > /dev/null
else
    echo -e "Updating repository: github.com/awojasinski/.dotfiles"
    git -C "$DOTFILES_DIR" pull --quiet > /dev/null
fi
